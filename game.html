<html>

<head>
   <title>MIDI Game 1</title>
   <link rel="icon" href="data:;base64,iVBORw0KGgo="/>

   <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>

   <script src="common.js"></script>
   <link rel="stylesheet" type="text/css" href="common.css"/>

   <script src="midi_devices.js"></script>
   <script src="quizzer.js"></script>

   <script src="ui.js"></script>
   <link rel="stylesheet" type="text/css" href="ui.css"/>

   <script src="keyboard.js"></script>
   <link rel="stylesheet" type="text/css" href="keyboard.css"/>

   <script src="vexflow-min.js"></script>
   <script src="score.js"></script>


   <script src="game.js"></script>
   <link rel="stylesheet" type="text/css" href="game.css"/>
   <script>

      var app = angular.module('game', ['keyboard']);
      app.controller('gameCtrl', function($scope, $http, $compile) {});

   
      function init() {
         var stave = new Score.Stave("stave", "treble");
         var octave = new Keyboard.Octave(document.getElementById('octave'));
         var quizzer = new Quizzer.NotesGame('user-points', 'timer', 'asked-note-name', stave);

         var game = new Game.Chapter1(quizzer, octave, 2000, []);

         var midi = new Midi.Controller(
            function(ok_flag, devices, msg) {
               if (!ok_flag) {
                  alert('Midi is unsupported by the browser: ' + msg);
                  return;
               }
               Common.initDeviceList(devices, document.getElementById('devices-list'));
               game.newRound();
            },
            function(octave, note_index) {
               game.onPress(octave, note_index);
            },
            function(octave, note_index) {
               game.onRelease(octave, note_index);
            }
         );
      };

      window.onload = function() {
      };

   </script>
</head>


<body data-ng-app='game'> 
   <div data-ng-controller='gameCtrl' data-ng-init='init2();'>
      <div id="user-points" onclick="init();">
         <span>Score: 0</span>
      </div>

      <div class='question-box' id='asked-note-name'><span></span></div>
      <div class='question-box' id='asked-note-symbol'>
         <!--span>?</span-->
         <canvas id='stave' width='150' height='150'></canvas>
      </div>

      <div id='timer-container'>
         <div id='timer' class="progress">
            <div class="caption"></div>
            <div class="boundary">
               <div class="halfcirc"></div>
               <div class="halfcirc second"></div>
            </div>
         </div>
      </div>

      <div id='keyboard'>
         <octave id='octave'></octave>
      </div>

      <div id='midi-devices'>
         <ul id='devices-list' class='devices'></ul>
      </div>
</body>

</html>
